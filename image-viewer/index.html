<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <link href="../libs/bootstrap5/bootstrap.min.css" rel="stylesheet" />
    <link href="../libs/viewerjs/viewer.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../common/common.css" />
    <script src="../common/common.js"></script>
    <script src="../libs/viewerjs/viewer.min.js"></script>
    <script src="../libs/bootstrap5/bootstrap.bundle.min.js"></script>
    <script src="../libs/i18next/i18next.min.js"></script>
    <script src="libs/exif-js/exif.js"></script>
    <script src="../libs/file-saver/FileSaver.min.js"></script>
    <style>
      .viewer-container {
        width: 100%;
        height: 100%;
      }

      #extFabMenu,
      #extFabMenu > ul {
        z-index: 3000;
      }

      .modal {
        z-index: 3002;
      }

      .viewer-button {
        visibility: hidden;
      }

      .viewer-backdrop {
        background-color: transparent;
      }
    </style>
    <script>
      let filePath = getParameterByName('file');
      let locale = getParameterByName('locale');
      if (locale === 'en') {
        locale = 'en_US';
      }

      document.onreadystatechange = () => {
        if (document.readyState === 'complete') {
          insertAboutDialog(
            'https://docs.tagspaces.org/extensions/image-viewer'
          );

          initI18N(locale, 'ns.viewerImage.json', 'locales');

          if (isCordova || isWeb) {
            // Cordova or web case
          } else {
            filePath = 'file://' + filePath;
          }

          let exifObj;

          // load settings for viewerSettings
          const extSettings = JSON.parse(
            localStorage.getItem('imageViewerSettings')
          );
          let imageBackgroundColor = '#000000';
          if (extSettings && extSettings.imageBackgroundColor) {
            imageBackgroundColor = extSettings.imageBackgroundColor;
          }

          // save settings for viewerSettings
          function saveExtSettings() {
            const settings = {
              imageBackgroundColor
            };
            localStorage.setItem(
              'imageViewerSettings',
              JSON.stringify(settings)
            );
            console.debug(settings);
          }

          let orientation;
          let viewer;
          const imageContent = document.getElementById('imageContent');

          if (
            filePath.toLowerCase().endsWith('.cr2') ||
            filePath.toLowerCase().endsWith('.dng') ||
            filePath.toLowerCase().endsWith('.nef') ||
            filePath.toLowerCase().endsWith('.tiff') ||
            filePath.toLowerCase().endsWith('.tif')
          ) {
            const script = document.createElement('script');
            script.onload = function() {
              const xhr = new XMLHttpRequest();
              xhr.responseType = 'arraybuffer';
              xhr.open('GET', filePath);
              xhr.onload = () => {
                const ifds = UTIF.decode(xhr.response);
                // UTIF.decodeImage(xhr.response, ifds[0]);
                const dataURL = UTIF.bufferToURI(xhr.response, ifds[0]);
                // const rgba = UTIF.toRGBA8(ifds[0]); // Uint8Array with RGBA pixels
                // console.log(ifds[0].width, ifds[0].height, ifds[0]);
                imageContent.setAttribute('src', dataURL);
              };
              xhr.send();
            };
            script.src = 'libs/utif.js/UTIF.js';
            document.head.appendChild(script);
          } else if (filePath.toLowerCase().endsWith('.psd')) {
            const script = document.createElement('script');
            script.onload = function() {
              const PSD = require('psd');
              PSD.fromURL(filePath)
                .then(psd => {
                  const image = psd.image.toPng();
                  imageContent.setAttribute('src', image.getAttribute('src'));
                  return true;
                })
                .catch(
                  e => console.warn('Error loading PSD') // : ' + JSON.stringify(e))
                );
            };
            script.src = 'libs/psd/dist/psd.min.js';
            document.head.appendChild(script);
          } else {
            imageContent.setAttribute('src', filePath);
          }

          let imageViewerContainer;

          imageContent.addEventListener('load', e => {
            const eTarget = event.target;
            viewer = new Viewer(document.getElementById('imageContent'), {
              movable: true,
              navbar: false,
              toolbar: false,
              title: false,
              transition: false,
              fullscreen: true,
              inline: 'inline',
              // fading: true,
              hide: e => {
                console.log(e.type);
              },
              viewed: () => {
                imageViewerContainer = document.getElementsByClassName(
                  'viewer-container'
                );
                imageViewerContainer[0].style.background = 'transparent';
                exifObj = {};
                exifObj['Width'] = eTarget.naturalWidth;
                exifObj['Height'] = eTarget.naturalHeight;

                if (
                  filePath.toLowerCase().includes('.jpg') ||
                  filePath.toLowerCase().includes('.jpeg')
                ) {
                  EXIF.getData(eTarget, () => {
                    orientation = EXIF.getTag(eTarget, 'Orientation');
                    // console.log(EXIF.pretty(this));
                    // Construct EXIF info
                    exifObj = {};
                    exifObj['Width'] = eTarget.naturalWidth;
                    exifObj['Height'] = eTarget.naturalHeight;
                    orientationText = '0°';
                    // 1= 0 degrees: the correct orientation, no adjustment is required.
                    // 2= 0 degrees, mirrored: image has been flipped back-to-front.
                    // 3= 180 degrees: image is upside down.
                    // 4= 180 degrees, mirrored: image has been flipped back-to-front and is upside down.
                    // 5= 90 degrees: image has been flipped back-to-front and is on its side.
                    // 6= 90 degrees, mirrored: image is on its side.
                    // 7= 270 degrees: image has been flipped back-to-front and is on its far side.
                    // 8= 270 degrees, mirrored: image is on its far side.
                    if (orientation === 1) {
                      orientationText = '0°';
                    } else if (orientation === 2) {
                      orientationText = '0°, mirrored';
                    } else if (orientation === 3) {
                      orientationText = '180°';
                    } else if (orientation === 4) {
                      orientationText = '180°, mirrored';
                    } else if (orientation === 5) {
                      orientationText = '90°';
                    } else if (orientation === 6) {
                      orientationText = '90°, mirrored°';
                    } else if (orientation === 7) {
                      orientationText = '270°';
                    } else if (orientation === 8) {
                      orientationText = '270°, mirrored';
                    }
                    if (orientation) {
                      exifObj['Orientation'] = orientationText;
                    }
                    const tags = [
                      'Make',
                      'Model',
                      'DateTime',
                      'Artist',
                      'Copyright',
                      'ExposureTime ',
                      'FNumber',
                      'Flash',
                      'WhiteBalance',
                      'ISOSpeedRatings',
                      'ShutterSpeedValue',
                      'ApertureValue',
                      'FocalLength',
                      'GPSLatitude',
                      'GPSLatitudeRef',
                      'GPSLongitude',
                      'GPSLongitudeRef'
                    ];
                    for (let tag in tags) {
                      const prop = tags[tag];
                      if (eTarget.exifdata.hasOwnProperty(prop)) {
                        exifObj[prop] = eTarget.exifdata[prop];
                      }
                    }
                    metaData = { ...exifObj, ...eTarget.iptcdata };
                    printEXIF(metaData);
                  });
                }
                printEXIF(exifObj);
              }
            });
            setTimeout(() => {
              viewer.full();
            }, 10); // fix for issue making first loaded image invisible by incorrect margin-top
          });

          imageContent.style['visibility'] = 'hidden';

          document
            .getElementById('exportJPGImage')
            .addEventListener('click', e => {
              toDataURL(imageContent.src, dataURL => {
                fetch(dataURL)
                  .then(res => res.blob())
                  .then(blob => {
                    saveAs(
                      blob,
                      extractFileName(filePath, isWin ? '\\' : '/') + '.jpg'
                    );
                  });
              });
            });

          document
            .getElementById('exportPNGImage')
            .addEventListener('click', e => {
              toDataURL(
                imageContent.src,
                dataURL => {
                  fetch(dataURL)
                    .then(res => res.blob())
                    .then(blob => {
                      saveAs(
                        blob,
                        extractFileName(filePath, isWin ? '\\' : '/') + '.png'
                      );
                    });
                },
                'png'
              );
            });

          document
            .getElementById('exportWEBPImage')
            .addEventListener('click', e => {
              toDataURL(
                imageContent.src,
                dataURL => {
                  fetch(dataURL)
                    .then(res => res.blob())
                    .then(blob => {
                      saveAs(
                        blob,
                        extractFileName(filePath, isWin ? '\\' : '/') + '.webp'
                      );
                    });
                },
                'webp'
              );
            });

          const offset = 0;
          document
            .getElementById('zoomInButton')
            .addEventListener('click', e => {
              e.stopPropagation();
              viewer.zoom(offset + 1);
            });

          document
            .getElementById('zoomOutButton')
            .addEventListener('click', e => {
              e.stopPropagation();
              viewer.zoom(offset - 1);
            });

          document
            .getElementById('zoomResetButton')
            .addEventListener('click', e => {
              viewer.zoomTo(1);
            });

          document
            .getElementById('fitToScreen')
            .addEventListener('click', e => {
              viewer.reset();
            });

          document
            .getElementById('rotateLeftButton')
            .addEventListener('click', e => {
              e.stopPropagation();
              viewer.rotate(-90);
            });

          document
            .getElementById('rotateRightButton')
            .addEventListener('click', e => {
              e.stopPropagation();
              viewer.rotate(90);
            });

          let flipHorizontal;
          let flipVertical;
          let flipBoth;
          let flipColor;
          document
            .getElementById('flipHorizontal')
            .addEventListener('click', e => {
              e.stopPropagation();
              if (flipHorizontal === true) {
                flipHorizontal = false;
                viewer.scaleX(1); // Flip horizontal
              } else {
                flipHorizontal = true;
                viewer.scaleX(-1); // Flip horizontal
              }
            });

          document
            .getElementById('flipVertical')
            .addEventListener('click', e => {
              e.stopPropagation();
              if (flipVertical === true) {
                flipVertical = false;
                viewer.scaleY(1); // Flip horizontal
              } else {
                flipVertical = true;
                viewer.scaleY(-1); // Flip vertical
              }
            });

          // document.getElementById('flipBoth').addEventListener('click', e => {
          //   e.stopPropagation();
          //   if (flipBoth === true) {
          //     flipBoth = false;
          //     viewer.scale(1); // Flip horizontal
          //   } else {
          //     flipBoth = true;
          //     viewer.scale(-1); // Flip both horizontal and vertical
          //   }
          // });

          document
            .getElementById('whiteBackgroundColor')
            .addEventListener('click', e => {
              e.stopPropagation();
              document.body.style.background = '#ffffff';
              imageViewerContainer[0].style.background = '#ffffff';
              imageBackgroundColor = '#ffffff';
              saveExtSettings();
            });

          document
            .getElementById('blackBackgroundColor')
            .addEventListener('click', e => {
              e.stopPropagation();
              document.body.style.background = '#000000';
              imageViewerContainer[0].style.background = '#000000';
              imageBackgroundColor = '#000000';
              saveExtSettings();
            });

          document
            .getElementById('sepiaBackgroundColor')
            .addEventListener('click', e => {
              e.stopPropagation();
              document.body.style.background = '#f4ecd8';
              imageViewerContainer[0].style.background = '#f4ecd8';
              imageBackgroundColor = '#f4ecd8';
              saveExtSettings();
            });

          document
            .getElementById('flipBlackAndWhiteColor')
            .addEventListener('click', e => {
              e.stopPropagation();
              if (flipColor) {
                flipColor = false;
                imageViewerContainer[0].style.filter = 'grayscale(0%)';
                imageViewerContainer[0].style.WebkitFilter = 'grayscale(0%)';
              } else {
                flipColor = true;
                imageViewerContainer[0].style.filter = 'grayscale(100%)'; // sepia(100%) brightness(50%) contrast(200%)
                imageViewerContainer[0].style.WebkitFilter = 'grayscale(100%)';
              }
            });

          document
            .getElementById('printMenuItem')
            .addEventListener('click', () => {
              setTimeout(() => {
                window.print();
              }, 300);
            });

          function printEXIF(metaData) {
            if (Object.keys(metaData).length < 1) {
              return;
            }
            const exifTableBody = document.getElementById('exifTableBody');
            exifTableBody.textContent = '';
            for (let key in metaData) {
              if (metaData.hasOwnProperty(key) && metaData[key].length !== 0) {
                const tr = document.createElement('tr');
                const th = document.createElement('th');
                const td = document.createElement('td');
                th.textContent = key;
                td.textContent = metaData[key];
                tr.appendChild(th);
                tr.appendChild(td);
                exifTableBody.appendChild(tr);
              }
            }
          }
        }
      };
    </script>
  </head>
  <body>
    <div
      id="imageContainer"
      style="width: 100%; height: 100%; display: block; margin: auto; object-fit: contain;"
    >
      <img
        id="imageContent"
        style="width: 100%; height: 100%; display: block; margin: auto; object-fit: contain;"
      />
    </div>

    <div
      class="modal fade"
      id="exifExtensionModal"
      tabindex="-1"
      aria-labelledby="exifModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5">
              <span data-i18n="exifTitle" />
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <table
              class="table table-striped table-sm"
              style="font-size: smaller;"
            >
              <thead>
                <!--tr><th>Key</th><th>Value</th></tr-->
              </thead>
              <tbody id="exifTableBody">
                <tr id="exifRow">
                  <th></th>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary"
              data-bs-dismiss="modal"
            >
              <span data-i18n="ok" />
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="btn-group dropup-center dropup"
      style="position: absolute; right: 20px; bottom: 20px;"
      id="extFabMenu"
    >
      <button
        type="button"
        class="btn btn-primary  btn-lg"
        data-bs-toggle="dropdown"
        aria-expanded="false"
        style="border-radius: 30px; font-weight: bolder; height: 50px"
      >
        ⋮
      </button>
      <ul class="dropdown-menu">
        <li>
          <div class="dropdown-item">
            <svg width="16" height="16" class="bi">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
              />
            </svg>
            <div
              class="btn-group"
              role="group"
              aria-label="Zoom control"
              style="width: 150px; border: 1px solid gray;"
            >
              <button
                id="zoomOutButton"
                type="button"
                class="btn"
                data-i18ntitle="zoomOut"
                style="border-right: 1px solid gray"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                  />
                  <path
                    d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"
                  />
                  <path
                    fill-rule="evenodd"
                    d="M3 6.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"
                  />
                </svg>
              </button>
              <button
                id="zoomInButton"
                type="button"
                class="btn"
                data-i18ntitle="zoomIn"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"
                  />
                  <path
                    d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"
                  />
                  <path
                    fill-rule="evenodd"
                    d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"
                  />
                </svg>
              </button>
            </div>
          </div>
        </li>
        <li>
          <div id="resetButtons" class="dropdown-item">
            <svg width="16" height="16" class="bi">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
              />
            </svg>
            <div
              class="btn-group"
              data-toggle="buttons"
              style="width: 150px; border: 1px solid gray;"
            >
              <button
                id="zoomResetButton"
                class="btn"
                data-i18ntitle="zoomReset"
                style="border-right: 1px solid gray"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    d="M5.5 0a.5.5 0 0 1 .5.5v4A1.5 1.5 0 0 1 4.5 6h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5zm5 0a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 10 4.5v-4a.5.5 0 0 1 .5-.5zM0 10.5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 6 11.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zm10 1a1.5 1.5 0 0 1 1.5-1.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4z"
                  />
                </svg>
              </button>
              <button id="fitToScreen" class="btn" data-i18ntitle="fitToScreen">
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"
                  />
                </svg>
              </button>
            </div>
          </div>
        </li>
        <li><hr class="dropdown-divider" /></li>
        <li>
          <div id="rotateButtons" class="dropdown-item">
            <svg width="16" height="16" class="bi">
              <path
                d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"
              />
              <path
                fill-rule="evenodd"
                d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"
              />
            </svg>
            <div
              class="btn-group"
              data-toggle="buttons"
              style="width: 150px; border: 1px solid gray;"
            >
              <button
                id="rotateRightButton"
                class="btn"
                data-i18ntitle="rotateRight"
                style="border-right: 1px solid gray"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"
                  />
                  <path
                    d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"
                  />
                </svg>
              </button>
              <button
                id="rotateLeftButton"
                class="btn"
                data-i18ntitle="rotateLeft"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"
                  />
                  <path
                    d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"
                  />
                </svg>
              </button>
            </div>
          </div>
        </li>
        <li>
          <div id="flipButtons" class="dropdown-item">
            <svg width="16" height="16" class="bi">
              <path
                fill-rule="evenodd"
                d="M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10zM.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708l-2-2zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8z"
              />
            </svg>
            <div
              class="btn-group"
              data-toggle="buttons"
              style="width: 150px; border: 1px solid gray;"
            >
              <button
                id="flipHorizontal"
                class="btn"
                data-i18ntitle="flipHorizontal"
                style="border-right: 1px solid gray"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"
                  />
                </svg>
              </button>
              <button
                id="flipVertical"
                class="btn"
                data-i18ntitle="flipVertical"
              >
                <svg width="16" height="16" class="bi">
                  <path
                    fill-rule="evenodd"
                    d="M11.5 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L11 2.707V14.5a.5.5 0 0 0 .5.5zm-7-14a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L4 13.293V1.5a.5.5 0 0 1 .5-.5z"
                  />
                </svg>
              </button>
            </div>
          </div>
        </li>
        <li><hr class="dropdown-divider" /></li>
        <li>
          <div class="dropdown-item" id="themeStyle">
            <svg width="16" height="16" class="bi">
              <path
                d="M12.433 10.07C14.133 10.585 16 11.15 16 8a8 8 0 1 0-8 8c1.996 0 1.826-1.504 1.649-3.08-.124-1.101-.252-2.237.351-2.92.465-.527 1.42-.237 2.433.07zM8 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM5 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"
              />
            </svg>
            <div
              class="btn-group"
              data-toggle="buttons"
              style="width: 150px; border: 1px solid gray;"
            >
              <a
                id="whiteBackgroundColor"
                class="btn"
                style="background-color: #ffffff; color: #282a36;"
                data-i18ntitle="changeBackgroundColor"
                >&nbsp;</a
              >
              <a
                id="blackBackgroundColor"
                class="btn"
                style="background-color: #282a36; color: #ffffff;"
                data-i18ntitle="changeBackgroundColor"
                >&nbsp;</a
              >
              <a
                id="sepiaBackgroundColor"
                class="btn"
                style="background-color: #f4ecd8; color: #5b4636;"
                data-i18ntitle="changeBackgroundColor"
                >&nbsp;</a
              >
            </div>
          </div>
        </li>
        <li>
          <a id="flipBlackAndWhiteColor" class="dropdown-item">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-heptagon-half"
              viewBox="0 0 16 16"
            >
              <path
                d="M7.779.052a.5.5 0 0 1 .442 0l6.015 2.97a.5.5 0 0 1 .267.34l1.485 6.676a.5.5 0 0 1-.093.415l-4.162 5.354a.5.5 0 0 1-.395.193H4.662a.5.5 0 0 1-.395-.193L.105 10.453a.5.5 0 0 1-.093-.415l1.485-6.676a.5.5 0 0 1 .267-.34L7.779.053zM8 15h3.093l3.868-4.975-1.383-6.212L8 1.058V15z"
              />
            </svg>
            <span data-i18n="toggleBlackAndWhiteColor"></span>
          </a>
        </li>
        <li><hr class="dropdown-divider" /></li>
        <li>
          <a id="exportJPGImage" class="dropdown-item" href="#">
            <svg width="16" height="16" class="bi">
              <path
                fill-rule="evenodd"
                d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"
              />
              <path
                fill-rule="evenodd"
                d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"
              />
            </svg>
            <span
              data-i18n="exportJPGImage"
              data-i18ntitle="exportJPGImageTitle"
            />
          </a>
        </li>
        <li>
          <a id="exportPNGImage" class="dropdown-item" href="#">
            <svg width="16" height="16" class="bi">
              <path
                fill-rule="evenodd"
                d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"
              />
              <path
                fill-rule="evenodd"
                d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"
              />
            </svg>
            <span data-i18n="exportPNGImage" />
          </a>
        </li>
        <li>
          <a id="exportWEBPImage" class="dropdown-item" href="#">
            <svg width="16" height="16" class="bi">
              <path
                fill-rule="evenodd"
                d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"
              />
              <path
                fill-rule="evenodd"
                d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"
              />
            </svg>
            <span data-i18n="exportWEBPImage" />
          </a>
        </li>
        <li><hr class="dropdown-divider" /></li>
        <li>
          <a
            id="exifButton"
            class="dropdown-item"
            data-bs-toggle="modal"
            data-bs-target="#exifExtensionModal"
            ><svg width="16" height="16" class="bi">
              <path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z" />
              <path
                d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2zm.5 2a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0z"
              />
            </svg>
            <span data-i18n="exif"></span>
          </a>
        </li>
        <li>
          <a id="printMenuItem" class="dropdown-item" href="#">
            <svg width="16" height="16" class="bi">
              <path
                d="M5 1a2 2 0 0 0-2 2v1h10V3a2 2 0 0 0-2-2H5zm6 8H5a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1z"
              />
              <path
                d="M0 7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-1v-2a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2H2a2 2 0 0 1-2-2V7zm2.5 1a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"
              />
            </svg>
            <span data-i18n="print" />
          </a>
        </li>
        <li><hr class="dropdown-divider" /></li>
        <li>
          <a
            class="dropdown-item"
            href="#"
            data-bs-toggle="modal"
            data-bs-target="#aboutModal"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-info-circle-fill"
              viewBox="0 0 16 16"
            >
              <path
                d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"
              />
            </svg>
            <span data-i18n="about" />
          </a>
        </li>
      </ul>
    </div>
  </body>
</html>
