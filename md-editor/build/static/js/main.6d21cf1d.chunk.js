(this["webpackJsonp@tagspaces/md-editor"]=this["webpackJsonp@tagspaces/md-editor"]||[]).push([[0],{321:function(e,t,n){},332:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(37),o=n.n(a),c=n(6),s=n(10),d=n(4),u=n(100),f=n(23),l=n(99),m=n(145),p=n(31),w=n(149),v=n(147),g=n(146),b=n(148),O=n(1),j=n(348),h=n(144),y=n.n(h);function x(e,t,n){var i=Object(r.useRef)();Object(r.useEffect)((function(){var r=(null===n||void 0===n?void 0:n.current)||window;if(r&&r.addEventListener){i.current!==t&&(i.current=t);var a=function(e){(null===i||void 0===i?void 0:i.current)&&i.current(e)};return r.addEventListener(e,a),function(){r.removeEventListener(e,a)}}}),[e,n,t])}n(315),n(316),n(317),n(318),n(319),n(320),n(321);var E,k=n(26),L=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(!1),n=Object(s.a)(t,2),i=n[0];n[1];Object(r.useEffect)((function(){h()}),[]);var a=function(){return window.editMode},o=function(){return window.mdContent},h=function(){var e=function(e){var t=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search),r=null===n?"":decodeURIComponent(n[1].replace(/\+/g," "));r.includes("#")&&(r=r.split("#").join("%23"));return r}("file"),t=document.URL.startsWith("http")&&!document.URL.startsWith("http://localhost:1212/")||e.startsWith("http");if(i){var n=document.getElementsByClassName("milkdown");if(n.length>0){if(!a()){var r=n[0].getElementsByTagName("a");Object(c.a)(r).forEach((function(e){var n,r=e.getAttribute("href");r&&0===r.indexOf("#")||(E(r)||(n=(t?"":"file://")+window.fileDirectory+"/"+encodeURIComponent(r),e.setAttribute("href",n)),e.addEventListener("click",(function(e){e.preventDefault(),window.parent.postMessage(JSON.stringify({command:"openLinkExternally",link:n||r}),"*")})))}))}var o=n[0].getElementsByTagName("img");Object(c.a)(o).forEach((function(e){var n=e.getAttribute("src");if(!E(n)){var r=(t?"":"file://")+window.fileDirectory+"/"+n;e.setAttribute("src",r)}}))}}};function E(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("file://")||0===e.indexOf("data:")}x("keyup",(function(e){a()&&(e.ctrlKey||e.metaKey)&&"s"===e.key.toLowerCase()?window.parent.postMessage(JSON.stringify({command:"saveDocument"}),"*"):(e.ctrlKey||e.metaKey)&&"p"===e.key.toLowerCase()&&window.print()})),x("dblclick",(function(e){a()||window.parent.postMessage(JSON.stringify({command:"editDocument"}),"*")})),x("contentLoaded",(function(){if(e.current){var t=e.current.get();t&&t.action((function(e){var t=e.get(d.j),n=e.get(d.n)(o());if(n){var r=t.state;t.dispatch(r.tr.replace(0,r.doc.content.size,new O.j(n.content,0,0)))}}))}}));var L={markdown:[function(e){a()&&(window.mdContent=e(),window.parent.postMessage(JSON.stringify({command:"contentChangedInEditor"}),"*"))}]},C=Object(u.b)((function(e){return d.b.make().config((function(t){t,t.set(d.r,e);var n=o();n&&t.set(d.i,n),t.set(l.b,L),t.set(d.k,{editable:a})})).use(f.p).use(w.a).use(l.a).use(b.a).use(m.a).use(p.c).use(v.a).use(g.a)}));return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(u.a,{ref:e,editor:C}),Object(k.jsx)(j.a,{color:"primary","aria-label":"add",children:Object(k.jsx)(y.a,{})})]})};E={command:"loadDefaultTextContent"},window.parent.postMessage(JSON.stringify(E),"*"),o.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsx)(L,{})}),document.getElementById("root"))}},[[332,1,2]]]);
//# sourceMappingURL=main.6d21cf1d.chunk.js.map