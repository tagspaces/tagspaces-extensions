(this["webpackJsonp@tagspaces/md-editor"]=this["webpackJsonp@tagspaces/md-editor"]||[]).push([[0],{354:function(e,t,n){},363:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(23),r=n.n(o),c=n(6),s=n(10),d=n(4),u=n(120),l=n(31),p=n(119),f=n(172),m=n(42),b=n(176),j=n(174),g=n(173),O=n(175),h=n(2);function w(e,t,n){var a=Object(i.useRef)();Object(i.useEffect)((function(){var i=(null===n||void 0===n?void 0:n.current)||window;if(i&&i.addEventListener){a.current!==t&&(a.current=t);var o=function(e){(null===a||void 0===a?void 0:a.current)&&a.current(e)};return i.addEventListener(e,o),function(){i.removeEventListener(e,o)}}}),[e,n,t])}n(348),n(349),n(350),n(351),n(352),n(353),n(354);var v,x=n(388),y=n(398),E=n(395),k=n(392),D=n(393),S=n(394),C=n(168),L=n.n(C),M=n(170),N=n.n(M),R=n(399),J=n(400),A=n(397),T=n(22),U=Object(x.a)((function(e){return Object(y.a)({root:{transform:"translateZ(0px)",flexGrow:1},exampleWrapper:{position:"relative",marginTop:e.spacing(3),height:380},radioGroup:{margin:e.spacing(1,0)},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),left:e.spacing(2)}}})})),B=function(){var e=Object(i.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(i.useState)(!1),r=Object(s.a)(o,2),c=r[0],d=r[1],u=U(),l=[{icon:Object(T.jsx)(L.a,{}),name:"About",action:function(){return a(!0)}},{icon:Object(T.jsx)(N.a,{}),name:"Print",action:function(){return window.print()}}];return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(R.a,{ariaLabel:"SpeedDial example",className:u.speedDial,hidden:!1,icon:Object(T.jsx)(J.a,{}),onClose:function(){d(!1)},onOpen:function(){d(!0)},open:c,direction:"up",children:l.map((function(e){return Object(T.jsx)(A.a,{icon:e.icon,tooltipTitle:e.name,onClick:e.action},e.name)}))}),Object(T.jsxs)(E.a,{open:n,onClose:function(){a(!1)},"aria-labelledby":"simple-dialog-title",children:[Object(T.jsx)(k.a,{id:"simple-dialog-title",children:"About Title"}),Object(T.jsxs)(D.a,{children:["Please visit the",Object(T.jsx)(S.a,{href:"https://github.com/tagspaces/tagspaces-extensions/tree/main/md-editor",variant:"body2",children:"project page"}),"on GitHub for details about this extension."]})]})]})},I=function(){var e=Object(i.useRef)(null),t=Object(i.useState)(!1),n=Object(s.a)(t,2),a=n[0];n[1];Object(i.useEffect)((function(){v()}),[]);var o=function(){return window.editMode},r=function(){return window.mdContent},v=function(){var e=function(e){var t=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search),i=null===n?"":decodeURIComponent(n[1].replace(/\+/g," "));i.includes("#")&&(i=i.split("#").join("%23"));return i}("file"),t=document.URL.startsWith("http")&&!document.URL.startsWith("http://localhost:1212/")||e.startsWith("http");if(a){var n=document.getElementsByClassName("milkdown");if(n.length>0){if(!o()){var i=n[0].getElementsByTagName("a");Object(c.a)(i).forEach((function(e){var n,i=e.getAttribute("href");i&&0===i.indexOf("#")||(x(i)||(n=(t?"":"file://")+window.fileDirectory+"/"+encodeURIComponent(i),e.setAttribute("href",n)),e.addEventListener("click",(function(e){e.preventDefault(),window.parent.postMessage(JSON.stringify({command:"openLinkExternally",link:n||i}),"*")})))}))}var r=n[0].getElementsByTagName("img");Object(c.a)(r).forEach((function(e){var n=e.getAttribute("src");if(!x(n)){var i=(t?"":"file://")+window.fileDirectory+"/"+n;e.setAttribute("src",i)}}))}}};function x(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("file://")||0===e.indexOf("data:")}w("keyup",(function(e){o()&&(e.ctrlKey||e.metaKey)&&"s"===e.key.toLowerCase()?window.parent.postMessage(JSON.stringify({command:"saveDocument"}),"*"):(e.ctrlKey||e.metaKey)&&"p"===e.key.toLowerCase()&&window.print()})),w("dblclick",(function(e){o()||window.parent.postMessage(JSON.stringify({command:"editDocument"}),"*")})),w("contentLoaded",(function(){if(e.current){var t=e.current.get();t&&t.action((function(e){var t=e.get(d.j),n=e.get(d.n)(r());if(n){var i=t.state;t.dispatch(i.tr.replace(0,i.doc.content.size,new h.j(n.content,0,0)))}}))}}));var y={markdown:[function(e){o()&&(window.mdContent=e(),window.parent.postMessage(JSON.stringify({command:"contentChangedInEditor"}),"*"))}]},E=Object(u.b)((function(e){return d.b.make().config((function(t){t,t.set(d.r,e);var n=r();n&&t.set(d.i,n),t.set(p.b,y),t.set(d.k,{editable:o})})).use(l.p).use(b.a).use(p.a).use(O.a).use(f.a).use(m.c).use(j.a).use(g.a)}));return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(u.a,{ref:e,editor:E}),Object(T.jsx)(B,{})]})};v={command:"loadDefaultTextContent"},window.parent.postMessage(JSON.stringify(v),"*"),r.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(I,{})}),document.getElementById("root"))}},[[363,1,2]]]);
//# sourceMappingURL=main.77dcb3ce.chunk.js.map